@import "tailwindcss";

/* ---- Reset léger & base ---- */
:root { color-scheme: light; }
* { box-sizing: border-box; }
html, body { height: 100%; }
body {
  margin: 0;
  font-family: ui-sans-serif, system-ui, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
  background: linear-gradient(180deg, rgba(255,255,255,.6), rgba(0,0,0,.03));
}

/* Conteneur de page par défaut */
main {
  max-width: 920px;
  margin: 0 auto;
  padding: 16px 12px;
  list-style: none;
  display: grid;
  gap: 12px;
}

/* ---- Utilitaires simples (complètent Tailwind si besoin) ---- */
.card {
  padding: 14px;
  border: 1px solid #dedede;
  border-radius: 12px;
  background: linear-gradient(180deg, rgba(255,255,255,.9), rgba(0,0,0,.035));
  box-shadow: 0 10px 30px rgba(0,0,0,.10), 0 10px 30px rgba(0,0,0,.05) inset;
}

/* ===========================
   GRIMOIRE 3D (g3d-*)
   =========================== */

/* Scène centrée */
.grimoire3D {
  display: grid;
  place-content: center;
  padding: clamp(16px, 6vw, 48px) 16px;
}

/* Variables runtime pour l’animation/tilt */
.g3d {
  /* Largeur min/max + épaisseur (pages) */
  --w: clamp(260px, 60vw, 560px);
  --h: calc(var(--w) * 1.45);
  --thickness: 36px;
  --tiltX: 0deg;
  --tiltY: 0deg;

  width: var(--w);
  height: var(--h);
  position: relative;
  transform-style: preserve-3d;
  transition: transform 220ms ease;
}

/* Optionnel : tilt sur pointeur (si tu gères les CSS vars côté JS) */
/* .g3d { transform: rotateX(var(--tiltX)) rotateY(var(--tiltY)); } */

/* Couverture (dessus) */
.g3d-cover {
  position: absolute;
  inset: 0;
  transform: translateZ(calc(var(--thickness) * 0.5));
  border-radius: 8px;
  overflow: hidden;
  box-shadow:
    0 10px 30px rgba(0,0,0,.35),
    0 20px 40px rgba(0,0,0,.25) inset;
  background:
    radial-gradient(120% 100% at 0% 0%, rgba(255,255,255,.18), transparent 50%),
    linear-gradient(90deg, #0b3942 0, #3b5f2e 60%, #3b3125 100%);
  filter: brightness(.9);
}

/* Effet verni/brillance */
.g3d-cover-gloss {
  position: absolute;
  inset: 0;
  background:
    radial-gradient(100% 100% at 0% 0%, rgba(255,255,255,.18), transparent 50%),
    linear-gradient(90deg, rgba(0,0,0,.08), transparent 40% 60%, rgba(0,0,0,.12));
  mix-blend-mode: soft-light;
  pointer-events: none;
}

/* Tranche arrière (dos) */
.g3d-back {
  position: absolute;
  inset: 0;
  transform: translateZ(calc(var(--thickness) * -0.5));
  border-radius: 8px;
  background: linear-gradient(90deg, #8b4725 0, #554636 60%, #3b3125 100%);
  filter: brightness(.9);
}

/* Pile de pages (effet papier) */
.g3d-stack {
  position: absolute;
  inset: 6px 10px;
  transform-style: preserve-3d;
  transform: translateZ(calc(var(--thickness) * -0.02));
  border-radius: 6px;
  background:
    linear-gradient(180deg, #fff8e0 2px, #f3eed2 2px 4px) 0 0/100% 6px repeat,
    linear-gradient(90deg, rgba(0,0,0,.03), transparent 12% 88%, rgba(0,0,0,.06));
  box-shadow:
    0 0 0 1px rgba(0,0,0,.06) inset,
    0 0 0 1px rgba(0,0,0,.08);
}

/* Ombre posée sous l’objet (au sol) */
.g3d-shadow {
  position: absolute;
  left: 50%;
  bottom: -12%;
  width: 80%;
  height: 16%;
  transform: translateX(-50%) rotateX(90deg);
  background:
    radial-gradient(closest-side, rgba(0,0,0,.35), transparent 70%);
  filter: blur(10px);
  pointer-events: none;
}

/* Vignette globale autour de la scène (optionnel) */
.scene-vignette {
  position: absolute;
  inset: -8%;
  pointer-events: none;
  background:
    radial-gradient(ellipse at center,
      rgba(0,0,0,0) 55%,
      rgba(0,0,0,.25) 70%,
      rgba(0,0,0,.55) 100%);
  animation: g2_candleFlicker 3s ease-in-out infinite alternate;
}

/* ---- Arrière-plan type hall/temple (optionnel) ---- */
.bg-hall {
  background-image: url("/images/bg-hall.png");
  background-size: cover;
  background-attachment: fixed;
  background-position: 50% 50%;
  object-fit: cover;
}

/* ---- Texture parchemin (pages internes) ---- */
.bg-book {
  background-image: url("/images/parchment.png");
  background-size: cover;
  background-position: 50% 50%;
  object-fit: cover;
  border-radius: 8px;
}

/* ===========================
   Bougies décoratives (candles)
   =========================== */
.candles {
  position: relative;
  display: grid;
  place-content: center;
  gap: 12px;
}

.candle {
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  width: 28px;
  height: 48px;
  background: linear-gradient(#f0b97a, #c6743a);
  border-radius: 8px;
  box-shadow: 0 6px 18px rgba(0,0,0,.25);
}

/* Flamme + halo “safe names” pour éviter les collisions */
.g2_candle {
  position: absolute;
  top: -24px;
  left: 50%;
  width: 12px;
  height: 18px;
  transform: translateX(-50%);
  border-radius: 50% 50% 65% 65%;
  background:
    radial-gradient(circle at 50% 55%, #fff6c3 35%, #ffd64b 70%, rgba(255,156,47,.72));
  animation: g2_candleFlicker 1.8s ease-in-out infinite;
  filter: drop-shadow(0 0 8px rgba(255,210,90,.8));
}

.g2_halo {
  position: absolute;
  top: -8px;
  left: 50%;
  width: 120px;
  height: 120px;
  transform: translateX(-50%);
  pointer-events: none;
  background:
    radial-gradient(ellipse at center,
      rgba(255,190,100,.25) 0%,
      rgba(255,190,100,.0) 60%);
  filter: blur(18px);
  animation: g2_candleFlicker 2.6s ease-in-out infinite alternate;
}

/* Glow doux au centre du lutrin/grimoire */
.g2_bookGlow {
  position: absolute;
  inset-inline: 0;
  top: 58%;
  height: 58%;
  transform: translateY(-50%);
  background:
    radial-gradient(closest-side,
      rgba(160,110,255,.35),
      rgba(160,110,255,0) 65%);
  filter: blur(18px);
  animation: g2_bookGlow 2.8s ease-in-out infinite alternate;
}

/* ===========================
   Accessibilité
   =========================== */
@media (prefers-reduced-motion: reduce) {
  .g2_candle, .g2_halo, .g2_bookGlow, .scene-vignette, .g3d { 
    animation: none !important; 
    transition: none !important; 
  }
}

/* ===========================
   Animations (safe names)
   =========================== */
@keyframes g2_candleFlicker {
  0% { opacity: .85; transform: translateY(0) scale(1); }
  35% { filter: blur(1px); transform: translateY(-1px) scale(1.01); }
  65% { opacity: .95; filter: blur(0.5px); transform: translateY(0) scale(.995); }
  100% { opacity: .85; filter: blur(1px); transform: translateY(0) scale(1); }
}

@keyframes g2_bookGlow {
  0% { opacity: .55; transform: translateY(0) scale(1); }
  50% { opacity: .90; transform: translateY(-1px) scale(1.01); }
  100% { opacity: .55; transform: translateY(0) scale(1); }
}

/* Petite pulsation utile pour boutons/CTA dans le grimoire */
@keyframes g2_pulse {
  0% { transform: translateX(-2%) rotate(-2deg) scaleY(1.02); filter: drop-shadow(0 0 7px rgba(255,193,79,.7)); }
  50% { transform: translateX(0) rotate(-1deg) scaleY(1.01); filter: drop-shadow(0 0 10px rgba(255,193,79,.9)); }
  100% { transform: translateX(-2%) rotate(-2deg) scaleY(1.02); filter: drop-shadow(0 0 7px rgba(255,193,79,.7)); }
}

/* ===========================
   Helpers optionnels
   =========================== */

/* Masque une image <img> sans la supprimer (si tu migreras vers next/image) */
.img-cover {
  width: 100%;
  height: 100%;
  object-fit: cover;
}
/* Fallback/forcing: applique le fond sur toute la page */
html, body {
  min-height: 100%;
}
body {
  background: radial-gradient(closest-side, rgba(160,110,255,.35), rgba(210,120,255,0) 70%);
  background-attachment: fixed;
}

/* --- Bouton CTA bas --- */
.book-cta {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 12px 22px;
  border-radius: 14px;
  font-weight: 600;
  background: #8b5e34;
  color: #fff;
  transition: transform .06s ease, box-shadow .15s ease, filter .15s ease;
  box-shadow: 0 6px 18px rgba(139,94,52,.28);
}
.book-cta:hover { filter: brightness(1.06); }
.book-cta:active { transform: translateY(1px) scale(.995); }
.book-cta:focus-visible { outline: 3px solid #d9b88c; outline-offset: 3px; }
/* Fond hall + vignette */
.home-hero{
  min-height:100svh;
  background:
    radial-gradient(70% 55% at 50% 0%, rgba(22,28,106,.55), rgba(0,0,0,.85) 70%),
    url("/images/bg-hall.png");
  background-size: cover;
  background-position: center top;
}

/* 3D minimal pour la rotation */
.book-wrap{ perspective:1400px; transform-style:preserve-3d; }
.book-wrap img{ backface-visibility:hidden; }

/* Lueur */
.page-glow{
  position:absolute; left:0; right:0; top:18%; height:56%;
  background:radial-gradient(closest-side, rgba(255,232,160,.25), transparent 70%);
  filter:blur(40px);
}

/* Bouton primaire */
.btn-primary{
  border-radius:.9rem; background:#a35b16; color:#fff;
  padding:.9rem 1.25rem; font-weight:700; letter-spacing:.2px;
  box-shadow:0 10px 28px rgba(0,0,0,.35);
  transition:transform .08s ease, background .15s ease;
}
.btn-primary:hover{ background:#b86a1f; }
.btn-primary:active{ transform:translateY(1px) scale(.99); }
/* === Correctifs Home / grimoire === */

/* 1) Supprimer l'ancien cadre blanc s'il traîne encore */
.book-hit, .book-hit::before, .book-hit::after { 
  display: none !important;
}

/* 2) Lutrin : fond adouci + masque doux pour cacher le rectangle gris */
.lectern-img{
  mix-blend-mode: multiply;
  opacity: .92;
  filter: contrast(1.06) saturate(1.03) brightness(.98);
  -webkit-mask-image: radial-gradient(ellipse at center, #000 72%, transparent 100%);
          mask-image: radial-gradient(ellipse at center, #000 72%, transparent 100%);
}

/* (option) si jamais le masque n’est pas supporté par le navigateur,
   tu peux le désactiver en ajoutant la classe .no-mask sur <body> */
.no-mask .lectern-img{
  -webkit-mask-image: none;
  mask-image: none;
}
/* === Grimoire (image + animation) === */
.book-wrap{
  padding-top: clamp(40px, 8vh, 96px);
  display:flex; justify-content:center; align-items:flex-start;
  perspective: 1400px; /* déjà présent plus haut, ok si doublé */
}
.book-img{
  width: min(560px, 88vw);
  height: auto;
  transform-origin: 55% 55%;
  transform: rotateY(0deg) rotateX(0deg) translateZ(0);
  transition: transform .65s cubic-bezier(.22,.61,.36,1), filter .25s;
  filter: drop-shadow(0 30px 60px rgba(0,0,0,.35));
}
.book-open .book-img{
  transform: rotateY(-22deg) rotateX(2deg) translateY(-2px);
  filter: drop-shadow(0 40px 70px rgba(0,0,0,.45));
}

/* Accessibilité : réduit les animations si demandé */
@media (prefers-reduced-motion: reduce){
  .book-img { transition: none; }
}
/* --- KILL LEGACY OVERLAY --- */
.book-hit, .book-hit::before, .book-hit::after {
  display: none !important;
  border: 0 !important;
  outline: 0 !important;
  box-shadow: none !important;
}

/* Hint texte discret (pas de cadre blanc) */
.book-hint{
  position: absolute;
  left: 50%;
  bottom: clamp(14px, 5vh, 32px);
  transform: translateX(-50%);
  padding: 8px 12px;
  border: none !important;
  outline: none !important;
  box-shadow: none !important;
  border-radius: 9999px;
  background: rgba(0,0,0,.35);
  color: #eee;
  font-weight: 600;
  backdrop-filter: blur(6px);
}
/* --- Désactive tout cadre résiduel dans la zone cliquable --- */
.book-wrap, .book-wrap * , .book-wrap *::before, .book-wrap *::after {
  outline: 0 !important;
  border: 0 !important;
  box-shadow: none !important;
}

/* Conteneur du grimoire : couche au-dessus + surface stable */
.book-wrap{
  position: relative;
  z-index: 2;
  width: min(560px, 92vw);
  aspect-ratio: 4/3;
  margin: 0 auto;
  perspective: 1200px;
  transform-style: preserve-3d;
  display: grid;
  place-items: center;
}

/* Image du grimoire */
.book-img{
  width: 100%;
  height: 100%;
  object-fit: contain;
  backface-visibility: hidden;
  transform-origin: left center;
  filter: drop-shadow(0 14px 30px rgba(0,0,0,.6));
  transition: transform .6s ease, filter .3s ease, opacity .2s ease;
}
.book-open .book-img{ transform: rotateY(-18deg); filter: drop-shadow(0 10px 22px rgba(0,0,0,.45)); }

/* Hint = texte SEUL (pas de pastille) */
.book-hint{
  position: absolute;
  left: 50%;
  bottom: -1.75rem;
  transform: translateX(-50%);
  padding: 0;
  margin: 0;
  background: transparent !important;
  color: #fff;
  font-weight: 700;
  text-shadow: 0 2px 8px rgba(0,0,0,.6);
  pointer-events: none;
}
/* Reset pour le bouton grimoire (évite le cadre blanc natif) */
.book-btn{
  appearance: none;
  -webkit-appearance: none;
  background: transparent;
  border: 0;
  padding: 0;
  margin: 0;
  border-radius: 0;
  box-shadow: none;
  outline: none;
  -webkit-tap-highlight-color: transparent;
}
/* Option accessibilité : focus discret (tu peux le laisser à none si tu veux zéro cadre) */
.book-btn:focus{ outline: none; }
.book-btn:focus-visible{
  outline: none;            /* mets une bordure si tu veux un focus visible */
  outline-offset: 4px;
}
/* === Hard kill de tout cadre/outline dans la zone grimoire === */
.book-wrap, .book-wrap::before, .book-wrap::after,
.book-btn, .book-btn::before, .book-btn::after,
.book-img, .book-img::before, .book-img::after,
.book-hint, .book-hint::before, .book-hint::after {
  border: 0 !important;
  outline: 0 !important;
  box-shadow: none !important; /* n'affecte pas filter: drop-shadow(...) */
}

/* Déjà présent, mais on re-confirme pour mobile */
.book-btn {
  -webkit-tap-highlight-color: transparent;
  appearance: none;
  background: transparent;
}
.book-btn:focus,
.book-btn:focus-visible { outline: none !important; }
/* === Hard kill de tout cadre/outline dans la zone grimoire === */
.book-wrap, .book-wrap::before, .book-wrap::after,
.book-btn, .book-btn::before, .book-btn::after,
.book-img, .book-img::before, .book-img::after,
.book-hint, .book-hint::before, .book-hint::after {
  border: 0 !important;
  outline: 0 !important;
  box-shadow: none !important; /* ne touche pas aux drop-shadow via filter */
}

/* Bouton clic grimoire : aucun style UA (Chrome/Firefox) */
.book-btn {
  appearance: none;
  background: transparent;
  border: 0;
  border-radius: 0;
  -webkit-tap-highlight-color: transparent;
}
.book-btn:focus,
.book-btn:focus-visible { outline: none !important; }

/* Firefox : supprime l’inner border et l’anneau focus */
button::-moz-focus-inner { border: 0; }
button:-moz-focusring { outline: none !important; }
/* ===== S2S: désactivation des styles legacy hero/wrapper ===== */
.home-hero { background: none !important; }

.book-wrap {
  perspective: unset !important;
  transform-style: flat !important;
}

.book-wrap, .book-wrap * {
  border: 0 !important;
  box-shadow: none !important;
  transform: none !important;
  backface-visibility: visible !important;
}

.book-wrap::before,
.book-wrap::after {
  content: none !important;
  border: 0 !important;
  box-shadow: none !important;
}
/* ===== S2S: HERO BACKDROP + KILL OVERLAYS (OVERRIDES) ===== */

/* 2.1 - Le fond study derrière tout (si tu utilises .bg-hall, on le garde) */
html, body{
  background: none !important;   /* tue le dégradé global */
}

/* 2.2 - Neutraliser tout overlay/cadre hérité */
.home-hero,
.home-hero::before,
.home-hero::after,
.book-wrap,
.book-wrap::before,
.book-wrap::after,
.book-wrap *::before,
.book-wrap *::after,
.book-hit,
.book-hit::before,
.book-hit::after{
  background: none !important;
  border: 0 !important;
  outline: 0 !important;
  box-shadow: none !important;
  filter: none !important;
  opacity: 1 !important;
}

/* 2.3 - Lutrin: enlever le “multiply” et les filtres qui l’assombrissent */
.lectern-img{
  mix-blend-mode: normal !important;
  -webkit-mask-image: none !important;
  mask-image: none !important;
  filter: none !important;
}

/* 2.4 - S’assurer que .bg-hall couvre tout avec parallaxe */
.bg-hall{
  position: fixed;
  inset: 0;
  z-index: -1;
  background-image: url('/images/bg-hall.png'); /* chemin corrigé */
  background-repeat: no-repeat;
  background-size: cover;
  background-position: center 60%;
  background-attachment: fixed;
}
@media (max-width: 640px){
  .bg-hall{ background-position: center 70%; }
}

/* --- S2S: nettoyage bord lutrin & drop shadow --- */
.lectern-img{
  display:block;
  filter: drop-shadow(0 16px 26px rgba(0,0,0,.45));
  -webkit-mask-image: radial-gradient(ellipse at center, #000 72%, transparent 100%);
          mask-image: radial-gradient(ellipse at center, #000 72%, transparent 100%);
}
