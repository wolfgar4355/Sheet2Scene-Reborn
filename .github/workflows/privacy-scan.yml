name: ğŸ•µï¸ Privacy Scan (Maya)

on:
  push:
    branches: [ main ]

jobs:
  privacy-scan:
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ§­ Checkout repo
        uses: actions/checkout@v4

      - name: ğŸ§¹ Scan RGPD logs
        run: |
          echo "ğŸ” Analyse des logs et exports Supabase..."
          if grep -R "gmail.com" ./logs || grep -R "@" ./exports; then
            echo "âŒ DonnÃ©es personnelles dÃ©tectÃ©es dans les logs !"
            exit 1
          else
            echo "âœ… Logs conformes RGPD."
          fi

      - name: ğŸ“£ Notify Discord (optional)
        if: failure()
        uses: Ilshidur/action-discord@master
        with:
          webhook: ${{ secrets.DISCORD_WEBHOOK_URL }}
          args: |
            âš ï¸ **Privacy Scan (Maya)** a dÃ©tectÃ© des donnÃ©es personnelles dans les logs.
